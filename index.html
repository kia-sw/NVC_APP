<!DOCTYPE html>
<html lang="sv">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NVC Konfliktl√∂sare</title>
    <script crossorigin src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
    <script crossorigin src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.5/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue', sans-serif;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState } = React;

        // Icons
        const Heart = () => (
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path>
            </svg>
        );

        const ArrowRight = () => (
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <line x1="5" y1="12" x2="19" y2="12"></line>
                <polyline points="12 5 19 12 12 19"></polyline>
            </svg>
        );

        const ArrowLeft = () => (
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <line x1="19" y1="12" x2="5" y2="12"></line>
                <polyline points="12 19 5 12 12 5"></polyline>
            </svg>
        );

        const AlertCircle = () => (
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <circle cx="12" cy="12" r="10"></circle>
                <line x1="12" y1="8" x2="12" y2="12"></line>
                <line x1="12" y1="16" x2="12.01" y2="16"></line>
            </svg>
        );

        const CheckCircle2 = () => (
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M12 22c5.523 0 10-4.477 10-10S17.523 2 12 2 2 6.477 2 12s4.477 10 10 10z"></path>
                <path d="m9 12 2 2 4-4"></path>
            </svg>
        );

        const Lightbulb = () => (
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5"></path>
                <path d="M9 18h6"></path>
                <path d="M10 22h4"></path>
            </svg>
        );

        const Loader2 = () => (
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="animate-spin">
                <path d="M21 12a9 9 0 1 1-6.219-8.56"></path>
            </svg>
        );

        const MessageCircle = () => (
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"></path>
            </svg>
        );

        const Users = () => (
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"></path>
                <circle cx="9" cy="7" r="4"></circle>
                <path d="M22 21v-2a4 4 0 0 0-3-3.87"></path>
                <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
            </svg>
        );

        const NVCApp = () => {
            const [currentStep, setCurrentStep] = useState(0);
            const [responses, setResponses] = useState({
                conflict: '',
                observation: '',
                feelings: '',
                needs: '',
                request: '',
                empathy: ''
            });
            const [feedback, setFeedback] = useState(null);
            const [analysis, setAnalysis] = useState(null);
            const [loading, setLoading] = useState(false);
            const [error, setError] = useState(null);

            const analyzeObservation = (text) => {
                const judgmentWords = ['alltid', 'aldrig', 'borde', 'm√•ste', 'fel', 'r√§tt', 'd√•lig', 'bra', 'lat', 'oansvarig', 'inkompetent', 'elak', 'dum'];
                const interpretationWords = ['vill inte', 'bryr sig inte', 'avsiktligt', 'medvetet', 'f√∂rs√∂ker', 'menar att'];
                
                const foundJudgments = judgmentWords.filter(word => text.toLowerCase().includes(word));
                const foundInterpretations = interpretationWords.filter(word => text.toLowerCase().includes(word));
                
                if (foundJudgments.length > 0 || foundInterpretations.length > 0) {
                    return {
                        type: 'warning',
                        message: 'Jag m√§rker n√•gra v√§rdeladdade ord i din observation:',
                        issues: [
                            ...foundJudgments.map(w => `"${w}" √§r en v√§rdering`),
                            ...foundInterpretations.map(w => `"${w}" √§r en tolkning av avsikt`)
                        ],
                        suggestion: 'F√∂rs√∂k beskriva bara vad du s√•g eller h√∂rde.',
                        phrases: ['Jag s√•g/h√∂rde att...', 'N√§r X h√§nde...']
                    };
                }
                
                return {
                    type: 'success',
                    message: 'Bra! Din observation √§r objektiv och konkret.',
                    suggestion: 'Du beskriver fakta utan v√§rderingar.',
                    phrases: []
                };
            };

            const analyzeFeelings = (text) => {
                const pseudoFeelings = ['att du', 'att han', 'att hon', 'att de', 'ignorerad', 'f√∂rr√•dd', 'attackerad', 'missf√∂rst√•dd'];
                const genuineFeelings = ['glad', 'ledsen', 'r√§dd', 'arg', 'frustrerad', 'besviken', 'orolig', 'nerv√∂s', 'stressad'];
                
                const foundPseudo = pseudoFeelings.filter(word => text.toLowerCase().includes(word));
                const foundGenuine = genuineFeelings.filter(word => text.toLowerCase().includes(word));
                
                if (foundPseudo.length > 0) {
                    return {
                        type: 'warning',
                        message: 'Jag ser att du blandar k√§nslor med tankar:',
                        issues: foundPseudo.map(w => `"${w}" √§r en tanke/tolkning`),
                        suggestion: 'Fokusera p√• vad DU k√§nner.',
                        phrases: ['Jag k√§nner mig ledsen n√§r...', 'Jag k√§nner mig frustrerad...']
                    };
                }
                
                if (foundGenuine.length > 0) {
                    return {
                        type: 'success',
                        message: 'Utm√§rkt! Du uttrycker genuina k√§nslor.',
                        suggestion: 'Dessa k√§nslor pekar p√• viktiga behov.',
                        phrases: []
                    };
                }
                
                return {
                    type: 'info',
                    message: 'F√∂rs√∂k identifiera dina k√§nslor mer specifikt.',
                    suggestion: 'Vanliga k√§nslor: glad, ledsen, r√§dd, arg, frustrerad, besviken.',
                    phrases: ['N√§r jag t√§nker p√• detta k√§nner jag mig...']
                };
            };

            const analyzeNeeds = (text) => {
                const strategies = ['att han', 'att hon', 'att du', 'att de', 'skulle', 'm√•ste'];
                const universalNeeds = ['respekt', 'f√∂rst√•else', 'trygghet', 'autonomi', 'samh√∂righet', 'st√∂d', 'uppskattning', 'klarhet'];
                
                const foundStrategies = strategies.filter(word => text.toLowerCase().includes(word));
                const foundNeeds = universalNeeds.filter(word => text.toLowerCase().includes(word));
                
                if (foundStrategies.length > 0) {
                    return {
                        type: 'warning',
                        message: 'Du beskriver en strategi snarare √§n ett behov:',
                        issues: foundStrategies.map(w => `"${w}" indikerar ett krav`),
                        suggestion: 'Fr√•ga dig: Vad s√∂ker jag egentligen?',
                        phrases: ['Jag har behov av respekt...', 'Jag l√§ngtar efter f√∂rst√•else...']
                    };
                }
                
                if (foundNeeds.length > 0) {
                    return {
                        type: 'success',
                        message: 'Mycket bra! Du har identifierat universella behov.',
                        suggestion: `Behovet av ${foundNeeds[0]} √§r n√•got alla kan relatera till.`,
                        phrases: []
                    };
                }
                
                return {
                    type: 'info',
                    message: 'F√∂rs√∂k identifiera det underliggande behovet.',
                    suggestion: 'Vanliga behov: respekt, f√∂rst√•else, trygghet, autonomi, samh√∂righet.',
                    phrases: ['Mitt behov av ... √§r inte uppfyllt']
                };
            };

            const analyzeRequest = (text) => {
                const negative = ['inte', 'sluta', 'undvik', 'l√•t bli'];
                const vague = ['mer', 'b√§ttre', 'mindre', 'oftare'];
                
                const hasNegative = negative.some(word => text.toLowerCase().includes(word));
                const hasVague = vague.some(word => text.toLowerCase().includes(word));
                
                if (hasNegative) {
                    return {
                        type: 'warning',
                        message: 'Din beg√§ran √§r formulerad negativt:',
                        issues: ['Formulera vad du VILL ist√§llet'],
                        suggestion: 'Vad vill du att personen G√ñR?',
                        phrases: ['Skulle du kunna... ?', 'Vore du villig att... ?']
                    };
                }
                
                if (hasVague) {
                    return {
                        type: 'warning',
                        message: 'Din beg√§ran √§r lite vag:',
                        issues: ['Var specifik: VEM, VAD, N√ÑR?'],
                        suggestion: 'Exempel: "Kan du informera mig senast kl 15 dagen f√∂re?"',
                        phrases: []
                    };
                }
                
                return {
                    type: 'success',
                    message: 'Din beg√§ran √§r konkret och genomf√∂rbar!',
                    suggestion: 'Kom ih√•g: En beg√§ran √§r inte ett krav.',
                    phrases: []
                };
            };

            const generateNVCAnalysis = async () => {
                setLoading(true);
                setError(null);

                try {
                    const response = await fetch("https://api.anthropic.com/v1/messages", {
                        method: "POST",
                        headers: {
                            "Content-Type": "application/json",
                        },
                        body: JSON.stringify({
                            model: "claude-sonnet-4-20250514",
                            max_tokens: 2000,
                            messages: [
                                {
                                    role: "user",
                                    content: `Du √§r en erfaren NVC-coach (Nonviolent Communication enligt Marshall Rosenberg). Analysera denna persons specifika situation och ge personlig, konkret v√§gledning.

PERSONENS SITUATION:
Konflikt: "${responses.conflict}"
Observation: "${responses.observation}"
K√§nslor: "${responses.feelings}"
Behov: "${responses.needs}"
Beg√§ran: "${responses.request}"
Den andras perspektiv: "${responses.empathy}"

GE ETT JSON-SVAR (inget annat, bara ren JSON) med denna struktur:
{
  "nvc_analys": "En kort analys av deras NVC-formulering - vad √§r bra och vad kan f√∂rb√§ttras? Anv√§nd DERAS exakta ord fr√•n svaren.",
  
  "f√∂rb√§ttrad_formulering": "Hur personen kan s√§ga det enligt NVC, med DERAS ord och situation. B√∂rja med observation, sen k√§nslor, behov, beg√§ran.",
  
  "dialogexempel": "Ett konkret dialogexempel f√∂r JUST DENNA situation. Anv√§nd DERAS observation och ord. Visa 3 scenarier: 1) Om personen lyssnar 2) Om personen blir defensiv 3) Hur man hanterar det med NVC. Varje scenario 3-4 repliker.",
  
  "konkreta_steg": [
    "Steg 1 med EXAKT vad personen ska g√∂ra f√∂r DENNA situation",
    "Steg 2...",
    "Steg 3...",
    "Steg 4...",
    "Steg 5..."
  ],
  
  "empatitips": "Konkreta tips f√∂r hur personen kan lyssna empatiskt p√• DEN ANDRA PERSONEN i DENNA situation. Anv√§nd personens beskrivning av den andras perspektiv.",
  
  "varningar": "Specifika saker att undvika i JUST DENNA situation baserat p√• konfliktens natur."
}`
                                }
                            ]
                        })
                    });

                    if (!response.ok) {
                        throw new Error(`API-fel: ${response.status}`);
                    }

                    const data = await response.json();
                    const content = data.content[0].text;
                    const cleanContent = content.replace(/```json|```/g, '').trim();
                    const parsedAnalysis = JSON.parse(cleanContent);
                    
                    setAnalysis(parsedAnalysis);
                } catch (err) {
                    console.error('Error:', err);
                    setError('Kunde inte skapa analys. Kontrollera din internetanslutning och f√∂rs√∂k igen.');
                } finally {
                    setLoading(false);
                }
            };

            const steps = [
                {
                    id: 'conflict',
                    title: 'Beskriv situationen',
                    question: 'Vad har h√§nt? Beskriv konflikten eller problemet:',
                    placeholder: 'Exempel: Min kollega kom inte till m√∂tet ig√•r och jag fick ta hela presentationen sj√§lv...',
                    help: 'Skriv fritt h√§r. Vi g√•r igenom NVC-stegen tillsammans.'
                },
                {
                    id: 'observation',
                    title: '1. Observation',
                    question: 'Vad h√§nde konkret? Beskriv bara vad du s√•g eller h√∂rde:',
                    placeholder: 'Exempel: Min kollega var inte p√• m√∂tet kl 14:00 ig√•r.',
                    help: 'T√§nk som en videokamera: Vad skulle den spela in?',
                    analyze: analyzeObservation
                },
                {
                    id: 'feelings',
                    title: '2. K√§nslor',
                    question: 'Vilka k√§nslor v√§cks i dig?',
                    placeholder: 'Exempel: Jag k√§nner mig frustrerad, besviken och √∂vergiven.',
                    help: 'Undvik "jag k√§nner att du..." - fokusera p√• vad DU k√§nner.',
                    analyze: analyzeFeelings
                },
                {
                    id: 'needs',
                    title: '3. Behov',
                    question: 'Vilket behov hos dig √§r inte uppfyllt?',
                    placeholder: 'Exempel: Jag har behov av samarbete, p√•litlighet och st√∂d.',
                    help: 'Behov √§r universella - n√•got alla m√§nniskor har.',
                    analyze: analyzeNeeds
                },
                {
                    id: 'request',
                    title: '4. Beg√§ran',
                    question: 'Vad vill du konkret att den andra personen g√∂r?',
                    placeholder: 'Exempel: Skulle du kunna meddela mig minst 24 timmar i f√∂rv√§g n√§sta g√•ng?',
                    help: 'Var specifik och positiv (vad du VILL).',
                    analyze: analyzeRequest
                },
                {
                    id: 'empathy',
                    title: '5. Empati',
                    question: 'Vilka k√§nslor och behov tror du den andra personen har?',
                    placeholder: 'Exempel: Kanske k√§nner sig min kollega stressad och har behov av balans.',
                    help: 'Gissa den andras perspektiv - detta f√∂rbereder dig.'
                }
            ];

            const handleInputChange = (value) => {
                const stepId = steps[currentStep].id;
                setResponses(prev => ({ ...prev, [stepId]: value }));
                
                if (steps[currentStep].analyze && value.length > 20) {
                    const result = steps[currentStep].analyze(value);
                    setFeedback(result);
                } else {
                    setFeedback(null);
                }
            };

            const nextStep = () => {
                if (currentStep < steps.length - 1) {
                    setCurrentStep(currentStep + 1);
                    setFeedback(null);
                } else {
                    generateNVCAnalysis();
                }
            };

            const prevStep = () => {
                if (currentStep > 0) {
                    setCurrentStep(currentStep - 1);
                    setFeedback(null);
                }
            };

            const reset = () => {
                setCurrentStep(0);
                setResponses({
                    conflict: '',
                    observation: '',
                    feelings: '',
                    needs: '',
                    request: '',
                    empathy: ''
                });
                setFeedback(null);
                setAnalysis(null);
                setError(null);
            };

            const currentStepData = steps[currentStep];
            const currentValue = responses[currentStepData.id];
            const progress = ((currentStep + 1) / steps.length) * 100;

            if (loading) {
                return (
                    <div className="min-h-screen bg-gradient-to-br from-blue-50 via-purple-50 to-pink-50 p-4 md:p-6 flex items-center justify-center">
                        <div className="bg-white rounded-2xl shadow-xl p-12 text-center max-w-md">
                            <div className="w-16 h-16 text-purple-500 mx-auto mb-4"><Loader2 /></div>
                            <h2 className="text-xl font-bold text-gray-800 mb-2">Analyserar din situation...</h2>
                            <p className="text-gray-600">Din personliga NVC-coach skapar en skr√§ddarsydd l√∂sning baserad p√• dina svar.</p>
                        </div>
                    </div>
                );
            }

            if (error) {
                return (
                    <div className="min-h-screen bg-gradient-to-br from-blue-50 via-purple-50 to-pink-50 p-4 md:p-6 flex items-center justify-center">
                        <div className="bg-white rounded-2xl shadow-xl p-12 text-center max-w-md">
                            <div className="w-16 h-16 text-red-500 mx-auto mb-4"><AlertCircle /></div>
                            <h2 className="text-xl font-bold text-gray-800 mb-2">Ett fel uppstod</h2>
                            <p className="text-gray-600 mb-6">{error}</p>
                            <button
                                onClick={reset}
                                className="px-6 py-3 bg-purple-500 text-white rounded-lg font-semibold hover:bg-purple-600"
                            >
                                F√∂rs√∂k igen
                            </button>
                        </div>
                    </div>
                );
            }

            if (analysis) {
                return (
                    <div className="min-h-screen bg-gradient-to-br from-blue-50 via-purple-50 to-pink-50 p-4 md:p-6">
                        <div className="max-w-4xl mx-auto space-y-6">
                            <div className="bg-white rounded-2xl shadow-xl p-6">
                                <div className="flex items-center gap-3 mb-2">
                                    <div className="w-8 h-8 text-rose-500"><Heart /></div>
                                    <h1 className="text-2xl md:text-3xl font-bold text-gray-800">Din personliga NVC-l√∂sning</h1>
                                </div>
                                <p className="text-gray-600">Analyserad av NVC-expert</p>
                            </div>

                            <div className="bg-white rounded-2xl shadow-xl p-6">
                                <h2 className="text-xl font-bold text-gray-800 mb-4">üìä Analys av din NVC-formulering</h2>
                                <p className="text-gray-700 leading-relaxed whitespace-pre-line">{analysis.nvc_analys}</p>
                            </div>

                            <div className="bg-gradient-to-r from-purple-50 to-pink-50 rounded-2xl shadow-xl p-6">
                                <h2 className="text-xl font-bold text-gray-800 mb-4">‚ú® F√∂rb√§ttrad formulering</h2>
                                <p className="text-gray-700 leading-relaxed whitespace-pre-line italic">"{analysis.f√∂rb√§ttrad_formulering}"</p>
                            </div>

                            <div className="bg-white rounded-2xl shadow-xl p-6">
                                <h2 className="text-xl font-bold text-gray-800 mb-4 flex items-center gap-2">
                                    <div className="w-6 h-6 text-purple-600"><MessageCircle /></div>
                                    Dialogexempel f√∂r din situation
                                </h2>
                                <div className="bg-gray-50 rounded-lg p-4">
                                    <p className="text-gray-700 whitespace-pre-line leading-relaxed">{analysis.dialogexempel}</p>
                                </div>
                            </div>

                            <div className="bg-gradient-to-r from-green-50 to-emerald-50 rounded-2xl shadow-xl p-6">
                                <h2 className="text-xl font-bold text-gray-800 mb-4 flex items-center gap-2">
                                    <div className="w-6 h-6 text-green-600"><CheckCircle2 /></div>
                                    Konkreta steg f√∂r dig
                                </h2>
                                <ol className="space-y-3">
                                    {analysis.konkreta_steg.map((step, index) => (
                                        <li key={index} className="flex items-start gap-3">
                                            <span className="flex-shrink-0 w-8 h-8 bg-green-500 text-white rounded-full flex items-center justify-center font-bold text-sm">
                                                {index + 1}
                                            </span>
                                            <span className="text-gray-700 pt-1">{step}</span>
                                        </li>
                                    ))}
                                </ol>
                            </div>

                            <div className="bg-gradient-to-r from-blue-50 to-purple-50 rounded-2xl shadow-xl p-6">
                                <h2 className="text-xl font-bold text-gray-800 mb-3 flex items-center gap-2">
                                    <div className="w-6 h-6 text-blue-600"><Users /></div>
                                    S√• lyssnar du empatiskt
                                </h2>
                                <p className="text-gray-700 whitespace-pre-line leading-relaxed">{analysis.empatitips}</p>
                            </div>

                            <div className="bg-red-50 border-l-4 border-red-400 rounded-r-lg p-6">
                                <h2 className="text-xl font-bold text-gray-800 mb-3 flex items-center gap-2">
                                    <span className="text-2xl">‚ö†Ô∏è</span> Undvik detta i din situation
                                </h2>
                                <p className="text-gray-700 whitespace-pre-line">{analysis.varningar}</p>
                            </div>

                            <div className="text-center pb-6">
                                <button
                                    onClick={reset}
                                    className="px-8 py-3 bg-gray-200 text-gray-700 rounded-lg font-semibold hover:bg-gray-300 transition-all"
                                >
                                    Analysera en ny konflikt
                                </button>
                            </div>
                        </div>
                    </div>
                );
            }

            return (
                <div className="min-h-screen bg-gradient-to-br from-blue-50 via-purple-50 to-pink-50 p-4 md:p-6">
                    <div className="max-w-3xl mx-auto">
                        <div className="bg-white rounded-2xl shadow-xl p-6 md:p-8 mb-6">
                            <div className="flex items-center gap-3 mb-4">
                                <div className="w-8 h-8 text-rose-500"><Heart /></div>
                                <h1 className="text-2xl md:text-3xl font-bold text-gray-800">NVC Konfliktl√∂sare</h1>
                            </div>
                            
                            <div className="mb-6">
                                <div className="flex justify-between text-sm text-gray-600 mb-2">
                                    <span>Steg {currentStep + 1} av {steps.length}</span>
                                    <span>{Math.round(progress)}%</span>
                                </div>
                                <div className="w-full bg-gray-200 rounded-full h-2">
                                    <div 
                                        className="bg-gradient-to-r from-purple-500 to-pink-500 h-2 rounded-full transition-all duration-300"
                                        style={{ width: `${progress}%` }}
                                    />
                                </div>
                            </div>

                            <h2 className="text-xl md:text-2xl font-bold text-purple-600 mb-4">
                                {currentStepData.title}
                            </h2>

                            <div className="bg-blue-50 border-l-4 border-blue-400 p-4 mb-6">
                                <p className="text-gray-700 font-medium">{currentStepData.question}</p>
                            </div>

                            <textarea
                                value={currentValue}
                                onChange={(e) => handleInputChange(e.target.value)}
                                placeholder={currentStepData.placeholder}
                                className="w-full h-32 p-4 border-2 border-gray-200 rounded-lg focus:border-purple-400 focus:outline-none resize-none mb-4"
                            />

                            <div className="bg-yellow-50 border-l-4 border-yellow-400 p-4 mb-6">
                                <div className="flex items-start gap-2">
                                    <div className="w-5 h-5 text-yellow-600 flex-shrink-0 mt-0.5"><Lightbulb /></div>
                                    <p className="text-sm text-gray-700">{currentStepData.help}</p>
                                </div>
                            </div>

                            {feedback && (
                                <div className={`border-l-4 p-4 mb-6 rounded-r-lg ${
                                    feedback.type === 'success' ? 'bg-green-50 border-green-400' :
                                    feedback.type === 'warning' ? 'bg-orange-50 border-orange-400' :
                                    'bg-blue-50 border-blue-400'
                                }`}>
                                    <div className="flex items-start gap-2 mb-3">
                                        <div className={`w-5 h-5 flex-shrink-0 mt-0.5 ${
                                            feedback.type === 'success' ? 'text-green-600' : 'text-orange-600'
                                        }`}>
                                            {feedback.type === 'success' ? <CheckCircle2 /> : <AlertCircle />}
                                        </div>
                                        <p className="font-semibold text-gray-800">{feedback.message}</p>
                                    </div>
                                    
                                    {feedback.issues && feedback.issues.length > 0 && (
                                        <ul className="ml-7 mb-3 space-y-1">
                                            {feedback.issues.map((issue, i) => (
                                                <li key={i} className="text-sm text-gray-700">‚Ä¢ {issue}</li>
                                            ))}
                                        </ul>
                                    )}

                                    <p className="text-sm text-gray-700 mb-3 ml-7">{feedback.suggestion}</p>

                                    {feedback.phrases && feedback.phrases.length > 0 && (
                                        <div className="ml-7 bg-white bg-opacity-50 rounded-lg p-3">
                                            <p className="text-xs font-semibold text-gray-600 mb-2">üí¨ NVC-fraser:</p>
                                            {feedback.phrases.map((phrase, i) => (
                                                <p key={i} className="text-sm text-gray-700 italic mb-1">"{phrase}"</p>
                                            ))}
                                        </div>
                                    )}
                                </div>
                            )}

                            <div className="flex gap-3">
                                <button
                                    onClick={prevStep}
                                    disabled={currentStep === 0}
                                    className="flex items-center gap-2 px-6 py-3 bg-gray-200 text-gray-700 rounded-lg font-semibold hover:bg-gray-300 disabled:opacity-50 disabled:cursor-not-allowed transition-all"
                                >
                                    <div className="w-5 h-5"><ArrowLeft /></div>
                                    F√∂reg√•ende
                                </button>

                                <button
                                    onClick={nextStep}
                                    disabled={!currentValue.trim()}
                                    className="flex-1 flex items-center justify-center gap-2 px-6 py-3 bg-gradient-to-r from-purple-500 to-pink-500 text-white rounded-lg font-semibold hover:from-purple-600 hover:to-pink-600 disabled:opacity-50 disabled:cursor-not-allowed transition-all"
                                >
                                    {currentStep === steps.length - 1 ? 'F√• din personliga l√∂sning' : 'N√§sta steg'}
                                    <div className="w-5 h-5"><ArrowRight /></div>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        ReactDOM.render(<NVCApp />, document.getElementById('root'));
    </script>
</body>
</html>
