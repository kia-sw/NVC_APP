<!DOCTYPE html>
<html lang="sv">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NVC Konfliktl√∂sare</title>
    <script crossorigin src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
    <script crossorigin src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.5/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue', sans-serif;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState } = React;

        // Lucide React Icons som SVG komponenter
        const Heart = () => (
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path>
            </svg>
        );

        const ArrowRight = () => (
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <line x1="5" y1="12" x2="19" y2="12"></line>
                <polyline points="12 5 19 12 12 19"></polyline>
            </svg>
        );

        const ArrowLeft = () => (
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <line x1="19" y1="12" x2="5" y2="12"></line>
                <polyline points="12 19 5 12 12 5"></polyline>
            </svg>
        );

        const AlertCircle = () => (
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <circle cx="12" cy="12" r="10"></circle>
                <line x1="12" y1="8" x2="12" y2="12"></line>
                <line x1="12" y1="16" x2="12.01" y2="16"></line>
            </svg>
        );

        const CheckCircle2 = () => (
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M12 22c5.523 0 10-4.477 10-10S17.523 2 12 2 2 6.477 2 12s4.477 10 10 10z"></path>
                <path d="m9 12 2 2 4-4"></path>
            </svg>
        );

        const Lightbulb = () => (
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5"></path>
                <path d="M9 18h6"></path>
                <path d="M10 22h4"></path>
            </svg>
        );

        const MessageCircle = () => (
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"></path>
            </svg>
        );

        const Users = () => (
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"></path>
                <circle cx="9" cy="7" r="4"></circle>
                <path d="M22 21v-2a4 4 0 0 0-3-3.87"></path>
                <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
            </svg>
        );

        const NVCApp = () => {
            const [currentStep, setCurrentStep] = useState(0);
            const [responses, setResponses] = useState({
                conflict: '',
                observation: '',
                feelings: '',
                needs: '',
                request: '',
                empathy: ''
            });
            const [feedback, setFeedback] = useState(null);
            const [showResults, setShowResults] = useState(false);

            const analyzeObservation = (text) => {
                const judgmentWords = ['alltid', 'aldrig', 'borde', 'm√•ste', 'fel', 'r√§tt', 'd√•lig', 'bra', 'lat', 'oansvarig', 'inkompetent', 'elak', 'dum'];
                const interpretationWords = ['vill inte', 'bryr sig inte', 'avsiktligt', 'medvetet', 'f√∂rs√∂ker', 'menar att'];
                
                const foundJudgments = judgmentWords.filter(word => text.toLowerCase().includes(word));
                const foundInterpretations = interpretationWords.filter(word => text.toLowerCase().includes(word));
                
                if (foundJudgments.length > 0 || foundInterpretations.length > 0) {
                    return {
                        type: 'warning',
                        message: 'Jag m√§rker n√•gra v√§rdeladdade ord i din observation:',
                        issues: [
                            ...foundJudgments.map(w => `"${w}" √§r en v√§rdering`),
                            ...foundInterpretations.map(w => `"${w}" √§r en tolkning av avsikt`)
                        ],
                        suggestion: 'F√∂rs√∂k beskriva bara vad du s√•g eller h√∂rde. Exempel: Ist√§llet f√∂r "Han √§r lat" ‚Üí "Han l√§mnade in rapporten tre dagar efter deadline"',
                        phrases: [
                            'Jag s√•g/h√∂rde att...',
                            'N√§r X h√§nde...',
                            'Under m√∂tet sades/gjordes...'
                        ]
                    };
                }
                
                return {
                    type: 'success',
                    message: 'Bra! Din observation √§r objektiv och konkret.',
                    suggestion: 'Du beskriver fakta utan v√§rderingar. Detta skapar en grund f√∂r konstruktiv kommunikation.',
                    phrases: []
                };
            };

            const analyzeFeelings = (text) => {
                const pseudoFeelings = ['att du', 'att han', 'att hon', 'att de', 'ignorerad', 'f√∂rr√•dd', 'attackerad', 'missf√∂rst√•dd', 'anv√§nd'];
                const genuineFeelings = ['glad', 'ledsen', 'r√§dd', 'arg', 'frustrerad', 'besviken', 'orolig', 'nerv√∂s', 'stressad', 'entusiastisk', 'tacksam', 'hopp'];
                
                const foundPseudo = pseudoFeelings.filter(word => text.toLowerCase().includes(word));
                const foundGenuine = genuineFeelings.filter(word => text.toLowerCase().includes(word));
                
                if (foundPseudo.length > 0) {
                    return {
                        type: 'warning',
                        message: 'Jag ser att du blandar k√§nslor med tankar eller tolkningar:',
                        issues: foundPseudo.map(w => `"${w}" √§r en tanke/tolkning, inte en k√§nsla`),
                        suggestion: 'K√§nslor beskriver ditt inre tillst√•nd. Fr√•ga dig: Vad k√§nner JAG i min kropp och mitt hj√§rta?',
                        phrases: [
                            'Jag k√§nner mig ledsen n√§r...',
                            'Jag k√§nner mig frustrerad f√∂r att...',
                            'Jag k√§nner mig orolig eftersom...'
                        ]
                    };
                }
                
                if (foundGenuine.length > 0) {
                    return {
                        type: 'success',
                        message: 'Utm√§rkt! Du uttrycker genuina k√§nslor.',
                        suggestion: 'Dessa k√§nslor pekar p√• viktiga behov hos dig.',
                        phrases: []
                    };
                }
                
                return {
                    type: 'info',
                    message: 'F√∂rs√∂k identifiera dina k√§nslor mer specifikt.',
                    suggestion: 'Vanliga k√§nslor: glad, ledsen, r√§dd, arg, frustrerad, besviken, orolig, stressad.',
                    phrases: [
                        'N√§r jag t√§nker p√• detta k√§nner jag mig...',
                        'I min kropp m√§rker jag att jag √§r...'
                    ]
                };
            };

            const analyzeNeeds = (text) => {
                const strategies = ['att han', 'att hon', 'att du', 'att de', 'skulle', 'm√•ste'];
                const universalNeeds = ['respekt', 'f√∂rst√•else', 'trygghet', 'autonomi', 'samh√∂righet', 'st√∂d', 'uppskattning', 'f√∂rtroende', 'klarhet', 'samarbete'];
                
                const foundStrategies = strategies.filter(word => text.toLowerCase().includes(word));
                const foundNeeds = universalNeeds.filter(word => text.toLowerCase().includes(word));
                
                if (foundStrategies.length > 0) {
                    return {
                        type: 'warning',
                        message: 'Du beskriver en strategi (hur n√•gon ska bete sig) snarare √§n ett behov:',
                        issues: foundStrategies.map(w => `"${w}" indikerar ett krav p√• andras beteende`),
                        suggestion: 'Behov √§r universella. Fr√•ga dig: Vad s√∂ker jag egentligen?',
                        phrases: [
                            'Jag har behov av respekt...',
                            'Jag l√§ngtar efter f√∂rst√•else...',
                            'Mitt behov av autonomi...'
                        ]
                    };
                }
                
                if (foundNeeds.length > 0) {
                    return {
                        type: 'success',
                        message: 'Mycket bra! Du har identifierat universella m√§nskliga behov.',
                        suggestion: `Behovet av ${foundNeeds[0]} √§r n√•got alla m√§nniskor kan relatera till.`,
                        phrases: []
                    };
                }
                
                return {
                    type: 'info',
                    message: 'F√∂rs√∂k identifiera det underliggande behovet.',
                    suggestion: 'Vanliga behov: respekt, f√∂rst√•else, trygghet, autonomi, samh√∂righet, st√∂d.',
                    phrases: [
                        'Mitt behov av ... √§r inte uppfyllt',
                        'Jag s√∂ker ...'
                    ]
                };
            };

            const analyzeRequest = (text) => {
                const negative = ['inte', 'sluta', 'undvik', 'l√•t bli'];
                const vague = ['mer', 'b√§ttre', 'mindre', 'oftare'];
                
                const hasNegative = negative.some(word => text.toLowerCase().includes(word));
                const hasVague = vague.some(word => text.toLowerCase().includes(word));
                
                if (hasNegative) {
                    return {
                        type: 'warning',
                        message: 'Din beg√§ran √§r formulerad negativt (vad du INTE vill):',
                        issues: ['Negativa beg√§ran g√∂r det sv√•rt att veta vad du faktiskt vill'],
                        suggestion: 'Formulera positivt: Vad vill du att personen G√ñR ist√§llet?',
                        phrases: [
                            'Skulle du kunna... ?',
                            'Vore du villig att... ?'
                        ]
                    };
                }
                
                if (hasVague) {
                    return {
                        type: 'warning',
                        message: 'Din beg√§ran √§r lite vag:',
                        issues: ['Var specifik: VEM ska g√∂ra VAD, N√ÑR?'],
                        suggestion: 'Exempel: "Kan du informera mig senast kl 15 dagen f√∂re m√∂tet om du inte kan n√§rvara?"',
                        phrases: []
                    };
                }
                
                return {
                    type: 'success',
                    message: 'Din beg√§ran √§r konkret och genomf√∂rbar!',
                    suggestion: 'Kom ih√•g: En beg√§ran √§r inte ett krav.',
                    phrases: []
                };
            };

            const generateSolution = () => {
                const isWorkRelated = responses.conflict.toLowerCase().includes('kollega') || 
                                      responses.conflict.toLowerCase().includes('chef') ||
                                      responses.conflict.toLowerCase().includes('arbete') ||
                                      responses.conflict.toLowerCase().includes('m√∂te');
                
                const isRecurring = responses.conflict.toLowerCase().includes('igen') ||
                                    responses.conflict.toLowerCase().includes('alltid') ||
                                    responses.conflict.toLowerCase().includes('tredje') ||
                                    responses.conflict.toLowerCase().includes('flera');

                const dialogue = `SCENARIO 1 - Om personen √§r √∂ppen:

Du: "Hej, jag skulle vilja prata med dig om n√•got som √§r viktigt f√∂r mig. Har du 15 minuter nu eller senare idag?"

Personen: "Visst, vad g√§ller det?"

Du: "N√§r ${responses.observation.toLowerCase()}, k√§nner jag mig ${responses.feelings.toLowerCase()}, eftersom jag har behov av ${responses.needs.toLowerCase()}. ${responses.request}"

Personen: "Okej, jag f√∂rst√•r. Jag visste inte att du k√§nde s√•."

Du: "Tack f√∂r att du lyssnar. Jag √§r nyfiken - hur upplever du sj√§lv situationen? Vad t√§nker och k√§nner du kring det h√§r?"

Personen: "Jag har varit v√§ldigt stressad med..."

Du: "S√• om jag f√∂rst√•r dig r√§tt - du k√§nner dig stressad och √∂verbelastad, och har behov av mer tid eller avlastning? √Ñr det r√§tt uppfattat?"

Personen: "Ja, exakt."

Du: "Hur tror du att vi kan hitta en l√∂sning som fungerar f√∂r oss b√•da? Skulle det hj√§lpa om vi [konkret f√∂rslag baserat p√• deras behov]?"

---

SCENARIO 2 - Om personen blir defensiv:

Du: "N√§r ${responses.observation.toLowerCase()}, k√§nner jag mig ${responses.feelings.toLowerCase()}..."

Personen: "Men jag hade massor att g√∂ra! Du f√∂rst√•r inte hur mycket jag har p√• mitt bord!"

Du: [PAUSA - andas] "Jag h√∂r att du k√§nner dig pressad och kanske lite frustrerad √∂ver att jag tar upp det h√§r. St√§mmer det?"

Personen: "Ja! Jag g√∂r mitt b√§sta!"

Du: "Jag tror dig. Jag ser att du jobbar h√•rt. Mitt behov av ${responses.needs.toLowerCase()} handlar inte om att du inte g√∂r ditt b√§sta - det handlar om hur vi kan samarbeta b√§ttre. Kan vi tillsammans hitta ett s√§tt?"

Personen: [Lugnar ner sig] "Okej... vad t√§nker du?"

Du: "${responses.request} Skulle det fungera f√∂r dig?"

---

SCENARIO 3 - Om personen attackerar tillbaka:

Personen: "Och DU d√•? Du gl√∂mde ju sj√§lv att..."

Du: [VIKTIGT - bli inte defensiv] "Jag h√∂r att du ocks√• har upplevt situationer d√§r dina behov inte blivit uppfyllda. Det l√•ter viktigt. Kan vi f√∂rst avsluta det h√§r samtalet och sedan ta ett separat samtal om din upplevelse? Jag vill verkligen h√∂ra den."

Eller: "Det l√•ter som att du ocks√• har saker du beh√∂ver ta upp. Ska vi boka 30 minuter d√§r vi ger 15 minuter var till att prata om v√•ra respektive upplevelser?"`;

                const strategies = [
                    {
                        name: 'Sj√§lvempati f√∂rst',
                        description: 'INNAN du pratar med personen - skriv ner dina observationer, k√§nslor och behov. Ge dig sj√§lv empati. Fr√•ga dig: "Vad √§r mitt verkliga behov h√§r?" N√§r du k√§nner dig centrerad och kan uttrycka dig utan anklagelser - d√• √§r du redo.',
                        when_to_use: 'Alltid som f√∂rsta steg. Om du √§r f√∂r arg/uppr√∂rd - ge dig sj√§lv empati f√∂rst tills du kan prata lugnt.'
                    },
                    {
                        name: 'Empati-gissning',
                        description: 'Innan samtalet: skriv ner vad du TROR personen k√§nner och beh√∂ver. Detta √∂var din f√∂rm√•ga att se deras perspektiv. Under samtalet: anv√§nd fraser som "Undrar om du k√§nner dig..." eller "Kan det vara s√• att du beh√∂ver...?" - √§ven om du har fel visar det att du bryr dig.',
                        when_to_use: 'Alltid. S√§rskilt n√§r konflikten √§r k√§nslig eller du f√∂rv√§ntar dig motst√•nd.'
                    },
                    {
                        name: 'Tyst reflektion',
                        description: 'Efter att personen pratat: pausa 3-5 sekunder innan du svarar. Reflektera tillbaka vad du h√∂rt: "S√• du k√§nner dig [k√§nsla] eftersom du beh√∂ver [behov]?" V√§nta p√• bekr√§ftelse innan du forts√§tter.',
                        when_to_use: 'Under hela samtalet. Denna paus √§r AVG√ñRANDE f√∂r att personen ska k√§nna sig h√∂rd.'
                    },
                    {
                        name: 'Separera observation fr√•n tolkning',
                        description: 'Om personen s√§ger "Du bryr dig inte!" - svara INTE defensivt. Ist√§llet: "N√§r du s√§ger att jag inte bryr mig, k√§nner du dig s√•rad och beh√∂ver trygghet i att vara viktig f√∂r mig?" Detta omvandlar attacken till ett behov du kan m√∂ta.',
                        when_to_use: 'N√§r personen anv√§nder anklagande spr√•k eller tolkningar.'
                    }
                ];

                const actionPlan = [
                    'F√ñRBEREDELSE (15-30 min f√∂re): Skriv ner hela din NVC-formulering p√• papper. √ñva h√∂gt att s√§ga den. F√∂rest√§ll dig 3 olika s√§tt personen kan reagera och hur du ska hantera varje reaktion med empati. G√∂r 5 djupa andetag innan du g√•r till samtalet.',
                    
                    '√ñPPNING - Fr√•ga om till√•telse: "Jag har n√•got viktigt jag skulle vilja prata med dig om. Passar det nu eller ska vi boka en annan tid?" Detta visar respekt och √∂kar chansen att de lyssnar.',
                    
                    'DELA DIN NVC-FORMULERING: S√§g EXAKT din observation, k√§nslor, behov och beg√§ran. Anv√§nd "jag-spr√•k" genomg√•ende. Pausa efter behov - ge personen tid att ta in det. Tala l√•ngsamt och lugnt.',
                    
                    'HANTERA DEFENSIVITET: Om personen blir defensiv - ERK√ÑNN DET omedelbart: "Jag m√§rker att det h√§r kanske v√§cker stark reaktion hos dig. Det √§r okej. Kan du ber√§tta vad som h√§nder f√∂r dig just nu?" G√Ö ALDRIG I F√ñRSVAR. Din uppgift √§r att lyssna empatiskt.',
                    
                    'EMPATISKT LYSSNANDE: N√§r personen pratar - lyssna f√∂r att f√∂rst√• deras K√ÑNSLOR och BEHOV (inte f√∂r att f√∂rsvara dig eller motbevisa dem). Reflektera tillbaka: "L√•ter det som att du k√§nner [gissa k√§nsla] eftersom du beh√∂ver [gissa behov]?" Fr√•ga "√Ñr det r√§tt uppfattat?" Forts√§tt tills de s√§ger JA.',
                    
                    'GEMENSAM PROBLEML√ñSNING: N√§r b√•da k√§nner sig h√∂rda - fr√•ga: "Nu n√§r vi f√∂rst√•r varandras behov - hur kan vi hitta en l√∂sning som tillgodoser b√•de ditt behov av [X] och mitt behov av [Y]?" Brainstorma tillsammans. Skriv ner l√∂sningen ni kommer fram till.',
                    
                    'KONKRET √ñVERENSKOMMELSE: Formulera tydligt vad ni b√•da ska g√∂ra: "S√• f√∂r att sammanfatta - du kommer att [konkret handling] och jag kommer att [konkret handling]. √Ñr vi √∂verens?" Skriv ner det.',
                    
                    'UPPF√ñLJNING: Boka direkt en uppf√∂ljning: "Ska vi ses om en vecka och kolla hur det fungerar?" Detta visar att du √§r seri√∂s och engagerad i relationen.'
                ];

                const redFlags = `UNDVIK DESSA VANLIGA NVC-MISSTAG:

‚ùå "Jag k√§nner att du √§r oansvarig" - Detta √§r INTE en k√§nsla, det √§r en BED√ñMNING. K√§nsla: "Jag k√§nner mig frustrerad/besviken/orolig"

‚ùå "Jag k√§nner mig ignorerad" - Detta √§r en PSEUDOK√ÑNSLA (dold anklagelse). S√§g ist√§llet: "Jag k√§nner mig ledsen och ensam eftersom mitt behov av samh√∂righet inte √§r uppfyllt"

‚ùå "Du m√•ste sluta..." - Detta √§r ett KRAV, inte en beg√§ran. Beg√§ran: "Skulle du vara villig att...?" eller "Kan du...?"

‚ùå "Men det √§r ju ditt fel!" - NVC handlar INTE om att fastst√§lla skuld. Fokusera p√• behov och l√∂sningar.

‚ùå Att anv√§nda NVC som manipulation: "N√§r du inte lyssnar p√• mig k√§nner jag mig frustrerad eftersom jag beh√∂ver respekt, s√• DU M√ÖSTE..." - Detta √§r inte √§kta NVC. NVC √§r inte ett verktyg f√∂r att f√• din vilja igenom.

‚ùå Att s√§ga "Jag anv√§nder NVC nu" - Detta skapar distans. Prata naturligt men T√ÑNK enligt NVC-strukturen.

${isRecurring ? '\n‚ùå "Du g√∂r ALLTID detta!" - STOPPA. √Ñven om det h√§nt m√•nga g√•nger - fokusera p√• DEN SPECIFIKA H√ÑNDELSEN. N√§r tillit byggts upp kan ni prata om m√∂nstret.' : ''}

KRITISKT: Om personen blir mycket uppr√∂rd eller attackerande - PAUSA SAMTALET: "Jag m√§rker att det h√§r v√§cker stark reaktion. Ska vi ta en paus och forts√§tta n√§r vi b√•da k√§nner oss lugnare?" Tvinga aldrig fram ett samtal.`;

                const empathyTips = `DJUPDYKNING I EMPATISKT LYSSNANDE:

STEG 1 - N√§rvaro (2-3 minuter)
Innan ni b√∂rjar: L√§gg bort telefonen. Sitt ner. Andas. Best√§m dig f√∂r att helt och h√•llet LYSSNA. Din agenda f√•r v√§nta. S√§g till dig sj√§lv: "I detta √∂gonblick √§r det viktigaste att f√∂rst√• denna person."

STEG 2 - Observera utan att tolka
N√§r personen pratar - l√§gg m√§rke till deras:
‚Ä¢ Kroppsspr√•k (sp√§nd? avslappnad? undvikande √∂gonkontakt?)
‚Ä¢ Tonfall (arg? ledsen? frustrerad?)
‚Ä¢ Ord de anv√§nder upprepade g√•nger
GISSA vad detta s√§ger om deras K√ÑNSLOR och BEHOV

STEG 3 - Reflektera tillbaka (anv√§nd dessa EXAKTA fraser)
"L√•ter det som att du k√§nner dig [k√§nsla] eftersom ditt behov av [behov] inte √§r uppfyllt?"
"√Ñr du [k√§nsla] f√∂r att du beh√∂ver [behov]?"
"Undrar om du k√§nner [k√§nsla]... st√§mmer det?"

Om du gissar FEL - s√§g: "Hj√§lp mig f√∂rst√• - vad √§r det du k√§nner?"

STEG 4 - H√•ll utrymmet
Efter din reflektion - var TYST. R√§kna till 5 i huvudet. Ge personen tid att t√§nka.
Motst√• frestelsen att:
‚Ä¢ F√∂rklara dig
‚Ä¢ R√§tta dem
‚Ä¢ Ber√§tta din version
‚Ä¢ L√∂sa problemet
Bara LYSSNA.

STEG 5 - F√∂rdjupa f√∂rst√•elsen
N√§r personen bekr√§ftat att du f√∂rst√•tt - fr√•ga:
"Kan du ber√§tta mer om det?"
"Vad √§r det i det h√§r som k√§nns viktigast f√∂r dig?"
"Hur l√§nge har du k√§nt s√• h√§r?"

${responses.empathy}

AVANCERAD TEKNIK - Silent Empathy:
Om personen √§r f√∂r uppr√∂rd f√∂r att du ska reflektera tillbaka - ge TYST empati. Lyssna bara. Nicka. Ha √∂gonkontakt. Din n√§rvaro och lyssnande √§r empatin. N√§r de lugnat ner sig kan du reflektera tillbaka.

TECKEN P√Ö ATT DU LYCKAS:
‚Ä¢ Personen s√§ger "Exakt!" eller "Ja, precis!"
‚Ä¢ Deras kroppsspr√•k mjuknar
‚Ä¢ De ber√§ttar mer och djupare
‚Ä¢ De avslutar med "Tack f√∂r att du lyssnade"

OM DET INTE FUNGERAR:
Om personen forts√§tter vara defensiv trots din empati - de kanske inte √§r redo. S√§g: "Jag m√§rker att det h√§r √§r sv√•rt just nu. Kan vi forts√§tta en annan g√•ng?" Det √§r okej. NVC √§r inte magi - ibland beh√∂ver m√§nniskor tid.`;

                return {
                    dialogue,
                    strategies,
                    actionPlan,
                    redFlags,
                    empathyTips
                };
            };

            const steps = [
                {
                    id: 'conflict',
                    title: 'Beskriv situationen',
                    question: 'Vad har h√§nt? Beskriv konflikten eller problemet:',
                    placeholder: 'Exempel: Min kollega kom inte till m√∂tet ig√•r och jag fick ta hela presentationen sj√§lv. Det √§r tredje g√•ngen p√• en m√•nad...',
                    help: 'Skriv fritt h√§r. Vi kommer att g√• igenom NVC-stegen tillsammans.'
                },
                {
                    id: 'observation',
                    title: '1. Observation',
                    question: 'Vad h√§nde konkret? Beskriv bara vad du s√•g eller h√∂rde, utan v√§rderingar:',
                    placeholder: 'Exempel: Min kollega var inte p√• m√∂tet kl 14:00 ig√•r. Jag h√∂ll presentationen ensam i 30 minuter.',
                    help: 'T√§nk som en videokamera: Vad skulle den spela in?',
                    analyze: analyzeObservation
                },
                {
                    id: 'feelings',
                    title: '2. K√§nslor',
                    question: 'Vilka k√§nslor v√§cks i dig n√§r du t√§nker p√• detta?',
                    placeholder: 'Exempel: Jag k√§nner mig frustrerad, besviken och lite √∂vergiven.',
                    help: 'Undvik "jag k√§nner att du..." - fokusera p√• vad DU k√§nner.',
                    analyze: analyzeFeelings
                },
                {
                    id: 'needs',
                    title: '3. Behov',
                    question: 'Vilket behov hos dig √§r inte uppfyllt i denna situation?',
                    placeholder: 'Exempel: Jag har behov av samarbete, p√•litlighet och st√∂d i v√•rt gemensamma projekt.',
                    help: 'Behov √§r universella - n√•got alla m√§nniskor har.',
                    analyze: analyzeNeeds
                },
                {
                    id: 'request',
                    title: '4. Beg√§ran',
                    question: 'Vad vill du konkret att den andra personen g√∂r?',
                    placeholder: 'Exempel: Skulle du kunna meddela mig minst 24 timmar i f√∂rv√§g n√§sta g√•ng du inte kan komma?',
                    help: 'Var specifik och positiv (vad du VILL, inte vad du inte vill).',
                    analyze: analyzeRequest
                },
                {
                    id: 'empathy',
                    title: '5. Empati',
                    question: 'Vilka k√§nslor och behov tror du den andra personen har?',
                    placeholder: 'Exempel: Kanske k√§nner sig min kollega stressad och har behov av balans mellan arbete och privatliv.',
                    help: 'Gissa den andras perspektiv - detta f√∂rbereder dig f√∂r empatiskt lyssnande.'
                }
            ];

            const handleInputChange = (value) => {
                const stepId = steps[currentStep].id;
                setResponses(prev => ({ ...prev, [stepId]: value }));
                
                if (steps[currentStep].analyze && value.length > 20) {
                    const result = steps[currentStep].analyze(value);
                    setFeedback(result);
                } else {
                    setFeedback(null);
                }
            };

            const nextStep = () => {
                if (currentStep < steps.length - 1) {
                    setCurrentStep(currentStep + 1);
                    setFeedback(null);
                } else {
                    setShowResults(true);
                }
            };

            const prevStep = () => {
                if (currentStep > 0) {
                    setCurrentStep(currentStep - 1);
                    setFeedback(null);
                }
            };

            const reset = () => {
                setCurrentStep(0);
                setResponses({
                    conflict: '',
                    observation: '',
                    feelings: '',
                    needs: '',
                    request: '',
                    empathy: ''
                });
                setFeedback(null);
                setShowResults(false);
            };

            const currentStepData = steps[currentStep];
            const currentValue = responses[currentStepData.id];
            const progress = ((currentStep + 1) / steps.length) * 100;

            if (showResults) {
                const solution = generateSolution();
                
                return (
                    <div className="min-h-screen bg-gradient-to-br from-blue-50 via-purple-50 to-pink-50 p-4 md:p-6">
                        <div className="max-w-4xl mx-auto space-y-6">
                            <div className="bg-white rounded-2xl shadow-xl p-6">
                                <div className="flex items-center gap-3 mb-2">
                                    <div className="w-8 h-8 text-rose-500"><Heart /></div>
                                    <h1 className="text-2xl md:text-3xl font-bold text-gray-800">Din NVC-l√∂sning</h1>
                                </div>
                                <p className="text-gray-600">Baserat p√• din situation har jag skapat en komplett handlingsplan.</p>
                            </div>

                            <div className="bg-white rounded-2xl shadow-xl p-6">
                                <h2 className="text-xl font-bold text-gray-800 mb-4">Din NVC-kommunikation</h2>
                                <div className="bg-gradient-to-r from-purple-50 to-pink-50 rounded-lg p-4">
                                    <p className="text-gray-700 leading-relaxed">
                                        "N√§r <span className="font-semibold text-purple-700">{responses.observation}</span>, k√§nner jag mig <span className="font-semibold text-blue-700">{responses.feelings}</span>, eftersom jag har behov av <span className="font-semibold text-green-700">{responses.needs}</span>. <span className="font-semibold text-orange-700">{responses.request}</span>"
                                    </p>
                                </div>
                            </div>

                            <div className="bg-white rounded-2xl shadow-xl p-6">
                                <h2 className="text-xl font-bold text-gray-800 mb-4 flex items-center gap-2">
                                    <div className="w-6 h-6 text-purple-600"><MessageCircle /></div>
                                    Exempel p√• samtalet
                                </h2>
                                <div className="bg-gray-50 rounded-lg p-4">
                                    <p className="text-gray-700 whitespace-pre-line leading-relaxed">{solution.dialogue}</p>
                                </div>
                                <p className="text-sm text-gray-600 mt-3">
                                    Anpassa detta till din egen r√∂st och situation. Det viktiga √§r att h√•lla fast vid NVC-strukturen.
                                </p>
                            </div>

                            <div className="bg-white rounded-2xl shadow-xl p-6">
                                <h2 className="text-xl font-bold text-gray-800 mb-4 flex items-center gap-2">
                                    <div className="w-6 h-6 text-yellow-500"><Lightbulb /></div>
                                    M√∂jliga strategier
                                </h2>
                                <div className="space-y-4">
                                    {solution.strategies.map((strategy, index) => (
                                        <div key={index} className="border border-gray-200 rounded-lg p-4">
                                            <h3 className="font-bold text-purple-600 mb-2">{strategy.name}</h3>
                                            <p className="text-gray-700 mb-2">{strategy.description}</p>
                                            <p className="text-sm text-gray-600 italic">
                                                <strong>Anv√§nd n√§r:</strong> {strategy.when_to_use}
                                            </p>
                                        </div>
                                    ))}
                                </div>
                            </div>

                            <div className="bg-gradient-to-r from-green-50 to-emerald-50 rounded-2xl shadow-xl p-6">
                                <h2 className="text-xl font-bold text-gray-800 mb-4 flex items-center gap-2">
                                    <div className="w-6 h-6 text-green-600"><CheckCircle2 /></div>
                                    Din handlingsplan
                                </h2>
                                <ol className="space-y-3">
                                    {solution.actionPlan.map((step, index) => (
                                        <li key={index} className="flex items-start gap-3">
                                            <span className="flex-shrink-0 w-8 h-8 bg-green-500 text-white rounded-full flex items-center justify-center font-bold text-sm">
                                                {index + 1}
                                            </span>
                                            <span className="text-gray-700 pt-1">{step}</span>
                                        </li>
                                    ))}
                                </ol>
                            </div>

                            <div className="bg-gradient-to-r from-blue-50 to-purple-50 rounded-2xl shadow-xl p-6">
                                <h2 className="text-xl font-bold text-gray-800 mb-3 flex items-center gap-2">
                                    <div className="w-6 h-6 text-blue-600"><Users /></div>
                                    Tips f√∂r empatiskt lyssnande
                                </h2>
                                <p className="text-gray-700 whitespace-pre-line">{solution.empathyTips}</p>
                            </div>

                            <div className="bg-red-50 border-l-4 border-red-400 rounded-r-lg p-6">
                                <h2 className="text-xl font-bold text-gray-800 mb-3 flex items-center gap-2">
                                    <span className="text-2xl">‚ö†Ô∏è</span> Saker att undvika
                                </h2>
                                <p className="text-gray-700">{solution.redFlags}</p>
                            </div>

                            <div className="text-center pb-6">
                                <button
                                    onClick={reset}
                                    className="px-8 py-3 bg-gray-200 text-gray-700 rounded-lg font-semibold hover:bg-gray-300 transition-all"
                                >
                                    Analysera en ny konflikt
                                </button>
                            </div>
                        </div>
                    </div>
                );
            }

            return (
                <div className="min-h-screen bg-gradient-to-br from-blue-50 via-purple-50 to-pink-50 p-4 md:p-6">
                    <div className="max-w-3xl mx-auto">
                        <div className="bg-white rounded-2xl shadow-xl p-6 md:p-8 mb-6">
                            <div className="flex items-center gap-3 mb-4">
                                <div className="w-8 h-8 text-rose-500"><Heart /></div>
                                <h1 className="text-2xl md:text-3xl font-bold text-gray-800">NVC Konfliktl√∂sare</h1>
                            </div>
                            
                            <div className="mb-6">
                                <div className="flex justify-between text-sm text-gray-600 mb-2">
                                    <span>Steg {currentStep + 1} av {steps.length}</span>
                                    <span>{Math.round(progress)}%</span>
                                </div>
                                <div className="w-full bg-gray-200 rounded-full h-2">
                                    <div 
                                        className="bg-gradient-to-r from-purple-500 to-pink-500 h-2 rounded-full transition-all duration-300"
                                        style={{ width: `${progress}%` }}
                                    />
                                </div>
                            </div>

                            <h2 className="text-xl md:text-2xl font-bold text-purple-600 mb-4">
                                {currentStepData.title}
                            </h2>

                            <div className="bg-blue-50 border-l-4 border-blue-400 p-4 mb-6">
                                <p className="text-gray-700 font-medium">{currentStepData.question}</p>
                            </div>

                            <textarea
                                value={currentValue}
                                onChange={(e) => handleInputChange(e.target.value)}
                                placeholder={currentStepData.placeholder}
                                className="w-full h-32 p-4 border-2 border-gray-200 rounded-lg focus:border-purple-400 focus:outline-none resize-none mb-4"
                            />

                            <div className="bg-yellow-50 border-l-4 border-yellow-400 p-4 mb-6">
                                <div className="flex items-start gap-2">
                                    <div className="w-5 h-5 text-yellow-600 flex-shrink-0 mt-0.5"><Lightbulb /></div>
                                    <p className="text-sm text-gray-700">{currentStepData.help}</p>
                                </div>
                            </div>

                            {feedback && (
                                <div className={`border-l-4 p-4 mb-6 rounded-r-lg ${
                                    feedback.type === 'success' ? 'bg-green-50 border-green-400' :
                                    feedback.type === 'warning' ? 'bg-orange-50 border-orange-400' :
                                    'bg-blue-50 border-blue-400'
                                }`}>
                                    <div className="flex items-start gap-2 mb-3">
                                        <div className={`w-5 h-5 flex-shrink-0 mt-0.5 ${
                                            feedback.type === 'success' ? 'text-green-600' : 'text-orange-600'
                                        }`}>
                                            {feedback.type === 'success' ? <CheckCircle2 /> : <AlertCircle />}
                                        </div>
                                        <p className="font-semibold text-gray-800">{feedback.message}</p>
                                    </div>
                                    
                                    {feedback.issues && feedback.issues.length > 0 && (
                                        <ul className="ml-7 mb-3 space-y-1">
                                            {feedback.issues.map((issue, i) => (
                                                <li key={i} className="text-sm text-gray-700">‚Ä¢ {issue}</li>
                                            ))}
                                        </ul>
                                    )}

                                    <p className="text-sm text-gray-700 mb-3 ml-7">{feedback.suggestion}</p>

                                    {feedback.phrases && feedback.phrases.length > 0 && (
                                        <div className="ml-7 bg-white bg-opacity-50 rounded-lg p-3">
                                            <p className="text-xs font-semibold text-gray-600 mb-2">üí¨ NVC-fraser du kan anv√§nda:</p>
                                            {feedback.phrases.map((phrase, i) => (
                                                <p key={i} className="text-sm text-gray-700 italic mb-1">"{phrase}"</p>
                                            ))}
                                        </div>
                                    )}
                                </div>
                            )}

                            <div className="flex gap-3">
                                <button
                                    onClick={prevStep}
                                    disabled={currentStep === 0}
                                    className="flex items-center gap-2 px-6 py-3 bg-gray-200 text-gray-700 rounded-lg font-semibold hover:bg-gray-300 disabled:opacity-50 disabled:cursor-not-allowed transition-all"
                                >
                                    <div className="w-5 h-5"><ArrowLeft /></div>
                                    F√∂reg√•ende
                                </button>

                                <button
                                    onClick={nextStep}
                                    disabled={!currentValue.trim()}
                                    className="flex-1 flex items-center justify-center gap-2 px-6 py-3 bg-gradient-to-r from-purple-500 to-pink-500 text-white rounded-lg font-semibold hover:from-purple-600 hover:to-pink-600 disabled:opacity-50 disabled:cursor-not-allowed transition-all"
                                >
                                    {currentStep === steps.length - 1 ? 'Skapa l√∂sning' : 'N√§sta steg'}
                                    <div className="w-5 h-5"><ArrowRight /></div>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        ReactDOM.render(<NVCApp />, document.getElementById('root'));
    </script>
</body>
</html>